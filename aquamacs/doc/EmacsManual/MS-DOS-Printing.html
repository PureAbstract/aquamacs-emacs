<html lang="en">
<head>
<title>Printing and MS-DOS</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Printing and MS-DOS">
<meta name="generator" content="makeinfo 4.6">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
--></style>
<link rel="stylesheet" href="aquamacs.css" type="text/css" /></head>
<body>
<div class="node">
<p>
Node:&nbsp;<a name="MS-DOS%20Printing">MS-DOS Printing</a>,
Next:&nbsp;<a rel="next" accesskey="n" href="MS-DOS-and-MULE.html#MS-DOS%20and%20MULE">MS-DOS and MULE</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Text-and-Binary.html#Text%20and%20Binary">Text and Binary</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="MS-DOS.html#MS-DOS">MS-DOS</a>
<hr><br>
</div>

<h3 class="section">Printing and MS-DOS</h3>

<p>Printing commands, such as <code>lpr-buffer</code> (see <a href="Hardcopy.html#Hardcopy">Hardcopy</a>) and
<code>ps-print-buffer</code> (see <a href="PostScript.html#PostScript">PostScript</a>) can work in MS-DOS and
MS-Windows by sending the output to one of the printer ports, if a
Posix-style <code>lpr</code> program is unavailable.  The same Emacs
variables control printing on all systems (see <a href="Hardcopy.html#Hardcopy">Hardcopy</a>), but in
some cases they have different default values on MS-DOS and
MS-Windows.

   <p>If you want to use your local printer, printing on it in the usual DOS
manner, then set the Lisp variable <code>lpr-command</code> to <code>""</code> (its
default value) and <code>printer-name</code> to the name of the printer
port--for example, <code>"PRN"</code>, the usual local printer port (that's
the default), or <code>"LPT2"</code>, or <code>"COM1"</code> for a serial printer. 
You can also set <code>printer-name</code> to a file name, in which case
"printed" output is actually appended to that file.  If you set
<code>printer-name</code> to <code>"NUL"</code>, printed output is silently
discarded (sent to the system null device).

   <p>On MS-Windows, when the Windows network software is installed, you can
also use a printer shared by another machine by setting
<code>printer-name</code> to the UNC share name for that printer-for example,
<code>"//joes_pc/hp4si"</code>.  (It doesn't matter whether you use forward
slashes or backslashes here.)  To find out the names of shared printers,
run the command <code>net view</code> at a DOS command prompt to obtain a list
of servers, and <code>net view </code><var>server-name</var><code></code> to see the names of printers
(and directories) shared by that server.  Alternatively, click the
<code>Network Neighborhood</code> icon on your desktop, and look for machines
which share their printers via the network.

   <p>If the printer doesn't appear in the output of <code>net view</code>, or
if setting <code>printer-name</code> to the UNC share name doesn't produce a
hardcopy on that printer, you can use the <code>net use</code> command to
connect a local print port such as <code>"LPT2"</code> to the networked
printer.  For example, typing <kbd>net use LPT2:
\\joes_pc\hp4si</kbd><a rel="footnote" href="#fn-1"><sup>1</sup></a>
causes Windows to <dfn>capture</dfn> the LPT2 port and redirect the printed
material to the printer connected to the machine <code>joes_pc</code>. 
After this command, setting <code>printer-name</code> to <code>"LPT2"</code>
should produce the hardcopy on the networked printer.

   <p>With some varieties of Windows network software, you can instruct
Windows to capture a specific printer port such as <code>"LPT2"</code>, and
redirect it to a networked printer via the <code>Control&nbsp;Panel-&gt;Printers</code> applet instead of <code>net use</code>.

   <p>Some printers expect DOS codepage encoding of non-ASCII text, even
though they are connected to a Windows machine which uses a different
encoding for the same locale.  For example, in the Latin-1 locale, DOS
uses codepage 850 whereas Windows uses codepage 1252.  See <a href="MS-DOS-and-MULE.html#MS-DOS%20and%20MULE">MS-DOS and MULE</a>.  When you print to such printers from Windows, you can use the
<kbd>C-x RET c</kbd> (<code>universal-coding-system-argument</code>) command before
<kbd>M-x lpr-buffer</kbd>; Emacs will then convert the text to the DOS
codepage that you specify.  For example, <kbd>C-x RET c cp850-dos RET
M-x lpr-region RET</kbd> will print the region while converting it to the
codepage 850 encoding.  You may need to create the <code>cp</code><var>nnn</var><code></code>
coding system with <kbd>M-x codepage-setup</kbd>.

   <p>If you set <code>printer-name</code> to a file name, it's best to use an
absolute file name.  Emacs changes the working directory according to
the default directory of the current buffer, so if the file name in
<code>printer-name</code> is relative, you will end up with several such
files, each one in the directory of the buffer from which the printing
was done.

   <p>The commands <code>print-buffer</code> and <code>print-region</code> call the
<code>pr</code> program, or use special switches to the <code>lpr</code> program, to
produce headers on each printed page.  MS-DOS and MS-Windows don't
normally have these programs, so by default, the variable
<code>lpr-headers-switches</code> is set so that the requests to print page
headers are silently ignored.  Thus, <code>print-buffer</code> and
<code>print-region</code> produce the same output as <code>lpr-buffer</code> and
<code>lpr-region</code>, respectively.  If you do have a suitable <code>pr</code>
program (for example, from GNU Textutils), set
<code>lpr-headers-switches</code> to <code>nil</code>; Emacs will then call
<code>pr</code> to produce the page headers, and print the resulting output as
specified by <code>printer-name</code>.

   <p>Finally, if you do have an <code>lpr</code> work-alike, you can set the
variable <code>lpr-command</code> to <code>"lpr"</code>.  Then Emacs will use
<code>lpr</code> for printing, as on other systems.  (If the name of the
program isn't <code>lpr</code>, set <code>lpr-command</code> to specify where to
find it.)  The variable <code>lpr-switches</code> has its standard meaning
when <code>lpr-command</code> is not <code>""</code>.  If the variable
<code>printer-name</code> has a string value, it is used as the value for the
<code>-P</code> option to <code>lpr</code>, as on Unix.

   <p>A parallel set of variables, <code>ps-lpr-command</code>,
<code>ps-lpr-switches</code>, and <code>ps-printer-name</code> (see <a href="PostScript-Variables.html#PostScript%20Variables">PostScript Variables</a>), defines how PostScript files should be printed.  These
variables are used in the same way as the corresponding variables
described above for non-PostScript printing.  Thus, the value of
<code>ps-printer-name</code> is used as the name of the device (or file) to
which PostScript output is sent, just as <code>printer-name</code> is used for
non-PostScript printing.  (There are two distinct sets of variables in
case you have two printers attached to two different ports, and only one
of them is a PostScript printer.)

   <p>The default value of the variable <code>ps-lpr-command</code> is <code>""</code>,
which causes PostScript output to be sent to the printer port specified
by <code>ps-printer-name</code>, but <code>ps-lpr-command</code> can also be set to
the name of a program which will accept PostScript files.  Thus, if you
have a non-PostScript printer, you can set this variable to the name of
a PostScript interpreter program (such as Ghostscript).  Any switches
that need to be passed to the interpreter program are specified using
<code>ps-lpr-switches</code>.  (If the value of <code>ps-printer-name</code> is a
string, it will be added to the list of switches as the value for the
<code>-P</code> option.  This is probably only useful if you are using
<code>lpr</code>, so when using an interpreter typically you would set
<code>ps-printer-name</code> to something other than a string so it is
ignored.)

   <p>For example, to use Ghostscript for printing on an Epson printer
connected to the <code>LPT2</code> port, put this in your <code>_emacs</code> file:

<pre class="example">     (setq ps-printer-name t)  ; Ghostscript doesn't understand -P
     (setq ps-lpr-command "c:/gs/gs386")
     (setq ps-lpr-switches '("-q" "-dNOPAUSE"
     			"-sDEVICE=epson"
     			"-r240x72"
     			"-sOutputFile=LPT2"
     			"-Ic:/gs"))
     </pre>

<p>(This assumes that Ghostscript is installed in the <code>"c:/gs"</code>
directory.)

   <p>For backwards compatibility, the value of <code>dos-printer</code>
(<code>dos-ps-printer</code>), if it has a value, overrides the value of
<code>printer-name</code> (<code>ps-printer-name</code>), on MS-DOS and MS-Windows
only.

   <div class="footnote">
<hr>
<h4>Footnotes</h4>
<ol type="1">
<li><a name="fn-1"></a>
<p>
Note that the <code>net use</code> command requires the UNC share name to be
typed with the Windows-style backslashes, while the value of
<code>printer-name</code> can be set with either forward- or backslashes.</p>

   </ol><hr></div>

   </body></html>

